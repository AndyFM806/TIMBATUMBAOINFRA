<?xml version="1.0" ?>
<testsuites disabled="0" errors="0" failures="28" tests="64" time="0.0">
	<testsuite disabled="0" errors="0" failures="28" name="terraform scan" skipped="0" tests="64" time="0">
		<properties>
			<property name="directory" value="['/tf']"/>
			<property name="add_check" value="False"/>
			<property name="list" value="False"/>
			<property name="output" value="['junitxml']"/>
			<property name="output_file_path" value="results.xml"/>
			<property name="output_bc_ids" value="False"/>
			<property name="include_all_checkov_policies" value="True"/>
			<property name="quiet" value="False"/>
			<property name="compact" value="False"/>
			<property name="framework" value="['all']"/>
			<property name="skip_framework" value="[]"/>
			<property name="run_all_external_checks" value="False"/>
			<property name="soft_fail" value="False"/>
			<property name="skip_results_upload" value="False"/>
			<property name="repo_id" value="cli_repo/tf"/>
			<property name="branch" value="master"/>
			<property name="skip_download" value="False"/>
			<property name="use_enforcement_rules" value="False"/>
			<property name="external_modules_download_path" value=".external_modules"/>
			<property name="evaluate_variables" value="True"/>
			<property name="no_cert_verify" value="False"/>
			<property name="create_baseline" value="False"/>
			<property name="output_baseline_as_skipped" value="False"/>
			<property name="secrets_scan_file_type" value="[]"/>
			<property name="enable_secret_scan_all_files" value="False"/>
			<property name="block_list_secret_scan" value="[]"/>
			<property name="summary_position" value="top"/>
			<property name="skip_resources_without_violations" value="False"/>
			<property name="deep_analysis" value="False"/>
			<property name="no_fail_on_crash" value="False"/>
			<property name="mask" value="defaultdict(&lt;class 'set'&gt;, {})"/>
			<property name="scan_secrets_history" value="False"/>
			<property name="secrets_history_timeout" value="12h"/>
			<property name="custom_tool_name" value="Checkov"/>
		</properties>
		<testcase name="[NONE][CKV_AWS_93] Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)" classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_93] Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)" classname="/cloudfront-timbaTumbao.tf.aws_s3_bucket_policy.website_bucket_policy" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_70] Ensure S3 bucket does not allow an action with any Principal" classname="/cloudfront-timbaTumbao.tf.aws_s3_bucket_policy.website_bucket_policy" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_234] Verify logging preference for ACM certificates" classname="/cloudfront-timbaTumbao.tf.aws_acm_certificate.cloudfront" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_233] Ensure Create before destroy for ACM certificates" classname="/cloudfront-timbaTumbao.tf.aws_acm_certificate.cloudfront" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_305] Ensure CloudFront distribution has a default root object configured" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_216] Ensure CloudFront distribution is enabled" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_174] Verify CloudFront Distribution Viewer Certificate is using TLS v1.2 or higher" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_34] Ensure CloudFront distribution ViewerProtocolPolicy is set to HTTPS" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/modules/api/main.tf.module.api.aws_lambda_permission.apigw_invoke_inscripciones" file="/modules/api/main.tf"/>
		<testcase name="[NONE][CKV_AWS_301] Ensure that AWS Lambda function is not publicly accessible" classname="/modules/api/main.tf.module.api.aws_lambda_permission.apigw_invoke_inscripciones" file="/modules/api/main.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_iam_role.lambda_exec" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_iam_role.lambda_exec" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_iam_role.lambda_exec" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_iam_role_policy_attachment.basic_logs" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_iam_role_policy_attachment.dynamodb_managed" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_lambda_function.inscripciones" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_lambda_function.inscripciones" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_168] Ensure SQS queue policy is not public by only allowing specific services or principals to access it" classname="/modules/inscripcionesLambda/sqs-inscripciones.tf.module.lambda.aws_sqs_queue.inscripciones_dlq" file="/modules/inscripcionesLambda/sqs-inscripciones.tf"/>
		<testcase name="[NONE][CKV_AWS_168] Ensure SQS queue policy is not public by only allowing specific services or principals to access it" classname="/modules/inscripcionesLambda/sqs-inscripciones.tf.module.lambda.aws_sqs_queue.inscripciones_queue" file="/modules/inscripcionesLambda/sqs-inscripciones.tf"/>
		<testcase name="[NONE][CKV_AWS_41] Ensure no hard coded AWS access key and secret key exists in provider" classname="/provider.tf.aws.default" file="/provider.tf"/>
		<testcase name="[NONE][CKV2_AWS_54] Ensure AWS CloudFront distribution is using secure SSL protocols for HTTPS communication" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV2_AWS_42] Ensure AWS CloudFront distribution uses custom SSL certificate" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV2_AWS_71] Ensure AWS ACM Certificate domain name does not include wildcards" classname="/cloudfront-timbaTumbao.tf.aws_acm_certificate.cloudfront" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV2_AWS_51] Ensure AWS API Gateway endpoints uses client certificate authentication" classname="/modules/api/main.tf.module.api.aws_apigatewayv2_stage.prod" file="/modules/api/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_72] Ensure AWS CloudFront origin protocol policy enforces HTTPS-only" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_57] S3 Bucket has an ACL defined which allows public WRITE access." classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV2_AWS_77] Ensure AWS API Gateway Rest API attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability" classname="/modules/api/main.tf.module.api.aws_apigatewayv2_api.http" file="/modules/api/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_lambda_function.inscripciones" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_iam_role_policy_attachment.basic_logs" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_iam_role_policy_attachment.dynamodb_managed" file="/modules/inscripcionesLambda/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_46] Ensure AWS CloudFront Distribution with S3 have Origin Access set to enabled" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_20] S3 Bucket has an ACL defined which allows public READ access." classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV2_AWS_73] Ensure AWS SQS uses CMK not AWS default keys for encryption" classname="/modules/inscripcionesLambda/sqs-inscripciones.tf.module.lambda.aws_sqs_queue.inscripciones_dlq" file="/modules/inscripcionesLambda/sqs-inscripciones.tf"/>
		<testcase name="[NONE][CKV2_AWS_73] Ensure AWS SQS uses CMK not AWS default keys for encryption" classname="/modules/inscripcionesLambda/sqs-inscripciones.tf.module.lambda.aws_sqs_queue.inscripciones_queue" file="/modules/inscripcionesLambda/sqs-inscripciones.tf"/>
		<testcase name="[NONE][CKV_AWS_19] Ensure all data stored in the S3 bucket is securely encrypted at rest" classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf"/>
		<testcase name="[NONE][CKV_AWS_56] Ensure S3 bucket has 'restrict_public_buckets' enabled" classname="/bucket-timbaTumbao.tf.aws_s3_bucket_public_access_block.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure S3 bucket has 'restrict_public_buckets' enabled">
Resource: aws_s3_bucket_public_access_block.website_bucket
File: /bucket-timbaTumbao.tf: 26-37
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22

		26 | resource &quot;aws_s3_bucket_public_access_block&quot; &quot;website_bucket&quot; {
		27 |   bucket = aws_s3_bucket.website_bucket.id
		28 | 
		29 |   block_public_acls       = false
		30 |   # Evita que se apliquen ACLs públicas (Access Control Lists) a objetos o al bucket.
		31 |   block_public_policy     = false
		32 |   # Bloquea políticas de bucket que permitan acceso público.
		33 |   ignore_public_acls      = false
		34 |   # Ignora cualquier ACL pública existente en objetos.
		35 |   restrict_public_buckets = false
		36 |   # Restringe el acceso a buckets con políticas públicas.
		37 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_55] Ensure S3 bucket has ignore public ACLs enabled" classname="/bucket-timbaTumbao.tf.aws_s3_bucket_public_access_block.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure S3 bucket has ignore public ACLs enabled">
Resource: aws_s3_bucket_public_access_block.website_bucket
File: /bucket-timbaTumbao.tf: 26-37
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21

		26 | resource &quot;aws_s3_bucket_public_access_block&quot; &quot;website_bucket&quot; {
		27 |   bucket = aws_s3_bucket.website_bucket.id
		28 | 
		29 |   block_public_acls       = false
		30 |   # Evita que se apliquen ACLs públicas (Access Control Lists) a objetos o al bucket.
		31 |   block_public_policy     = false
		32 |   # Bloquea políticas de bucket que permitan acceso público.
		33 |   ignore_public_acls      = false
		34 |   # Ignora cualquier ACL pública existente en objetos.
		35 |   restrict_public_buckets = false
		36 |   # Restringe el acceso a buckets con políticas públicas.
		37 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_53] Ensure S3 bucket has block public ACLS enabled" classname="/bucket-timbaTumbao.tf.aws_s3_bucket_public_access_block.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure S3 bucket has block public ACLS enabled">
Resource: aws_s3_bucket_public_access_block.website_bucket
File: /bucket-timbaTumbao.tf: 26-37
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19

		26 | resource &quot;aws_s3_bucket_public_access_block&quot; &quot;website_bucket&quot; {
		27 |   bucket = aws_s3_bucket.website_bucket.id
		28 | 
		29 |   block_public_acls       = false
		30 |   # Evita que se apliquen ACLs públicas (Access Control Lists) a objetos o al bucket.
		31 |   block_public_policy     = false
		32 |   # Bloquea políticas de bucket que permitan acceso público.
		33 |   ignore_public_acls      = false
		34 |   # Ignora cualquier ACL pública existente en objetos.
		35 |   restrict_public_buckets = false
		36 |   # Restringe el acceso a buckets con políticas públicas.
		37 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_54] Ensure S3 bucket has block public policy enabled" classname="/bucket-timbaTumbao.tf.aws_s3_bucket_public_access_block.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure S3 bucket has block public policy enabled">
Resource: aws_s3_bucket_public_access_block.website_bucket
File: /bucket-timbaTumbao.tf: 26-37
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20

		26 | resource &quot;aws_s3_bucket_public_access_block&quot; &quot;website_bucket&quot; {
		27 |   bucket = aws_s3_bucket.website_bucket.id
		28 | 
		29 |   block_public_acls       = false
		30 |   # Evita que se apliquen ACLs públicas (Access Control Lists) a objetos o al bucket.
		31 |   block_public_policy     = false
		32 |   # Bloquea políticas de bucket que permitan acceso público.
		33 |   ignore_public_acls      = false
		34 |   # Ignora cualquier ACL pública existente en objetos.
		35 |   restrict_public_buckets = false
		36 |   # Restringe el acceso a buckets con políticas públicas.
		37 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_68] CloudFront Distribution should have WAF enabled" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf">
			<failure type="failure" message="CloudFront Distribution should have WAF enabled">
Resource: aws_cloudfront_distribution.website_distribution
File: /cloudfront-timbaTumbao.tf: 50-98
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-27

		50 | resource &quot;aws_cloudfront_distribution&quot; &quot;website_distribution&quot; {
		51 |   origin {
		52 |     domain_name = aws_s3_bucket.website_bucket.bucket_regional_domain_name
		53 |     origin_id   = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		54 | 
		55 |     s3_origin_config {
		56 |       origin_access_identity = aws_cloudfront_origin_access_identity.origin_access_identity.cloudfront_access_identity_path
		57 |     }
		58 |   }
		59 | 
		60 |   enabled         = true
		61 |   is_ipv6_enabled = true
		62 |   default_root_object = &quot;index.html&quot;
		63 | 
		64 |   # Si aún no tienes dominio, comenta esta parte (aliases) y usa solo el domain_name que da CloudFront
		65 |   aliases = [&quot;thumbnailcritique.com&quot;]
		66 | 
		67 |   default_cache_behavior {
		68 |     allowed_methods  = [&quot;GET&quot;, &quot;HEAD&quot;, &quot;OPTIONS&quot;]
		69 |     cached_methods   = [&quot;GET&quot;, &quot;HEAD&quot;]
		70 |     target_origin_id = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		71 | 
		72 |     forwarded_values {
		73 |       query_string = false
		74 |       cookies {
		75 |         forward = &quot;none&quot;
		76 |       }
		77 |     }
		78 | 
		79 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		80 |     min_ttl     = 0
		81 |     default_ttl = 3600
		82 |     max_ttl     = 86400
		83 |   }
		84 | 
		85 |   restrictions {
		86 |     geo_restriction {
		87 |       restriction_type = &quot;none&quot;
		88 |     }
		89 |   }
		90 | 
		91 |   viewer_certificate {
		92 |     acm_certificate_arn      = aws_acm_certificate.cloudfront.arn
		93 |     ssl_support_method       = &quot;sni-only&quot;
		94 |     minimum_protocol_version = &quot;TLSv1.2_2021&quot;
		95 |   }
		96 | 
		97 |   depends_on = [aws_acm_certificate_validation.cloudfront]
		98 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_374] Ensure AWS CloudFront web distribution has geo restriction enabled" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf">
			<failure type="failure" message="Ensure AWS CloudFront web distribution has geo restriction enabled">
Resource: aws_cloudfront_distribution.website_distribution
File: /cloudfront-timbaTumbao.tf: 50-98
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374

		50 | resource &quot;aws_cloudfront_distribution&quot; &quot;website_distribution&quot; {
		51 |   origin {
		52 |     domain_name = aws_s3_bucket.website_bucket.bucket_regional_domain_name
		53 |     origin_id   = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		54 | 
		55 |     s3_origin_config {
		56 |       origin_access_identity = aws_cloudfront_origin_access_identity.origin_access_identity.cloudfront_access_identity_path
		57 |     }
		58 |   }
		59 | 
		60 |   enabled         = true
		61 |   is_ipv6_enabled = true
		62 |   default_root_object = &quot;index.html&quot;
		63 | 
		64 |   # Si aún no tienes dominio, comenta esta parte (aliases) y usa solo el domain_name que da CloudFront
		65 |   aliases = [&quot;thumbnailcritique.com&quot;]
		66 | 
		67 |   default_cache_behavior {
		68 |     allowed_methods  = [&quot;GET&quot;, &quot;HEAD&quot;, &quot;OPTIONS&quot;]
		69 |     cached_methods   = [&quot;GET&quot;, &quot;HEAD&quot;]
		70 |     target_origin_id = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		71 | 
		72 |     forwarded_values {
		73 |       query_string = false
		74 |       cookies {
		75 |         forward = &quot;none&quot;
		76 |       }
		77 |     }
		78 | 
		79 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		80 |     min_ttl     = 0
		81 |     default_ttl = 3600
		82 |     max_ttl     = 86400
		83 |   }
		84 | 
		85 |   restrictions {
		86 |     geo_restriction {
		87 |       restriction_type = &quot;none&quot;
		88 |     }
		89 |   }
		90 | 
		91 |   viewer_certificate {
		92 |     acm_certificate_arn      = aws_acm_certificate.cloudfront.arn
		93 |     ssl_support_method       = &quot;sni-only&quot;
		94 |     minimum_protocol_version = &quot;TLSv1.2_2021&quot;
		95 |   }
		96 | 
		97 |   depends_on = [aws_acm_certificate_validation.cloudfront]
		98 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_86] Ensure CloudFront distribution has Access Logging enabled" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf">
			<failure type="failure" message="Ensure CloudFront distribution has Access Logging enabled">
Resource: aws_cloudfront_distribution.website_distribution
File: /cloudfront-timbaTumbao.tf: 50-98
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-20

		50 | resource &quot;aws_cloudfront_distribution&quot; &quot;website_distribution&quot; {
		51 |   origin {
		52 |     domain_name = aws_s3_bucket.website_bucket.bucket_regional_domain_name
		53 |     origin_id   = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		54 | 
		55 |     s3_origin_config {
		56 |       origin_access_identity = aws_cloudfront_origin_access_identity.origin_access_identity.cloudfront_access_identity_path
		57 |     }
		58 |   }
		59 | 
		60 |   enabled         = true
		61 |   is_ipv6_enabled = true
		62 |   default_root_object = &quot;index.html&quot;
		63 | 
		64 |   # Si aún no tienes dominio, comenta esta parte (aliases) y usa solo el domain_name que da CloudFront
		65 |   aliases = [&quot;thumbnailcritique.com&quot;]
		66 | 
		67 |   default_cache_behavior {
		68 |     allowed_methods  = [&quot;GET&quot;, &quot;HEAD&quot;, &quot;OPTIONS&quot;]
		69 |     cached_methods   = [&quot;GET&quot;, &quot;HEAD&quot;]
		70 |     target_origin_id = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		71 | 
		72 |     forwarded_values {
		73 |       query_string = false
		74 |       cookies {
		75 |         forward = &quot;none&quot;
		76 |       }
		77 |     }
		78 | 
		79 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		80 |     min_ttl     = 0
		81 |     default_ttl = 3600
		82 |     max_ttl     = 86400
		83 |   }
		84 | 
		85 |   restrictions {
		86 |     geo_restriction {
		87 |       restriction_type = &quot;none&quot;
		88 |     }
		89 |   }
		90 | 
		91 |   viewer_certificate {
		92 |     acm_certificate_arn      = aws_acm_certificate.cloudfront.arn
		93 |     ssl_support_method       = &quot;sni-only&quot;
		94 |     minimum_protocol_version = &quot;TLSv1.2_2021&quot;
		95 |   }
		96 | 
		97 |   depends_on = [aws_acm_certificate_validation.cloudfront]
		98 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_310] Ensure CloudFront distributions should have origin failover configured" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf">
			<failure type="failure" message="Ensure CloudFront distributions should have origin failover configured">
Resource: aws_cloudfront_distribution.website_distribution
File: /cloudfront-timbaTumbao.tf: 50-98
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310

		50 | resource &quot;aws_cloudfront_distribution&quot; &quot;website_distribution&quot; {
		51 |   origin {
		52 |     domain_name = aws_s3_bucket.website_bucket.bucket_regional_domain_name
		53 |     origin_id   = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		54 | 
		55 |     s3_origin_config {
		56 |       origin_access_identity = aws_cloudfront_origin_access_identity.origin_access_identity.cloudfront_access_identity_path
		57 |     }
		58 |   }
		59 | 
		60 |   enabled         = true
		61 |   is_ipv6_enabled = true
		62 |   default_root_object = &quot;index.html&quot;
		63 | 
		64 |   # Si aún no tienes dominio, comenta esta parte (aliases) y usa solo el domain_name que da CloudFront
		65 |   aliases = [&quot;thumbnailcritique.com&quot;]
		66 | 
		67 |   default_cache_behavior {
		68 |     allowed_methods  = [&quot;GET&quot;, &quot;HEAD&quot;, &quot;OPTIONS&quot;]
		69 |     cached_methods   = [&quot;GET&quot;, &quot;HEAD&quot;]
		70 |     target_origin_id = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		71 | 
		72 |     forwarded_values {
		73 |       query_string = false
		74 |       cookies {
		75 |         forward = &quot;none&quot;
		76 |       }
		77 |     }
		78 | 
		79 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		80 |     min_ttl     = 0
		81 |     default_ttl = 3600
		82 |     max_ttl     = 86400
		83 |   }
		84 | 
		85 |   restrictions {
		86 |     geo_restriction {
		87 |       restriction_type = &quot;none&quot;
		88 |     }
		89 |   }
		90 | 
		91 |   viewer_certificate {
		92 |     acm_certificate_arn      = aws_acm_certificate.cloudfront.arn
		93 |     ssl_support_method       = &quot;sni-only&quot;
		94 |     minimum_protocol_version = &quot;TLSv1.2_2021&quot;
		95 |   }
		96 | 
		97 |   depends_on = [aws_acm_certificate_validation.cloudfront]
		98 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_76] Ensure API Gateway has Access Logging enabled" classname="/modules/api/main.tf.module.api.aws_apigatewayv2_stage.prod" file="/modules/api/main.tf">
			<failure type="failure" message="Ensure API Gateway has Access Logging enabled">
Resource: module.api.aws_apigatewayv2_stage.prod
File: /modules/api/main.tf: 14-18
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-17

		14 | resource &quot;aws_apigatewayv2_stage&quot; &quot;prod&quot; {
		15 |   api_id      = aws_apigatewayv2_api.http.id
		16 |   name        = &quot;prod&quot;
		17 |   auto_deploy = true
		18 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_309] Ensure API GatewayV2 routes specify an authorization type" classname="/modules/api/main.tf.module.api.aws_apigatewayv2_route.inscripciones" file="/modules/api/main.tf">
			<failure type="failure" message="Ensure API GatewayV2 routes specify an authorization type">
Resource: module.api.aws_apigatewayv2_route.inscripciones
File: /modules/api/main.tf: 43-50
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-309

		43 | resource &quot;aws_apigatewayv2_route&quot; &quot;inscripciones&quot; {
		44 |   api_id    = aws_apigatewayv2_api.http.id
		45 |   route_key = &quot;POST /inscripciones&quot;
		46 |   target    = &quot;integrations/${aws_apigatewayv2_integration.inscripciones.id}&quot;
		47 | 
		48 |   authorization_type = var.enable_cognito_auth &amp;&amp; var.jwt_issuer != null &amp;&amp; length(var.jwt_audiences) &gt; 0 ? &quot;JWT&quot; : &quot;NONE&quot;
		49 |   authorizer_id      = var.enable_cognito_auth &amp;&amp; var.jwt_issuer != null &amp;&amp; length(var.jwt_audiences) &gt; 0 ? aws_apigatewayv2_authorizer.cognito[0].id : null
		50 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_lambda_function.inscripciones" file="/modules/inscripcionesLambda/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: module.lambda.aws_lambda_function.inscripciones
File: /modules/inscripcionesLambda/main.tf: 50-70
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		50 | resource &quot;aws_lambda_function&quot; &quot;inscripciones&quot; {
		51 |   function_name = var.lambda_function_name
		52 |   role          = aws_iam_role.lambda_exec.arn
		53 |   handler       = var.lambda_handler
		54 |   runtime       = &quot;java17&quot;
		55 | 
		56 |   # Empaquetado: JAR ya compilado
		57 |   filename         = local.jar_path_abs
		58 |   source_code_hash = filebase64sha256(local.jar_path_abs)
		59 | 
		60 |   timeout     = 15
		61 |   memory_size = 512
		62 | 
		63 |   environment {
		64 |     variables = {
		65 |       DDB_TABLE = var.ddb_table_name
		66 |       STAGE     = var.stage
		67 |     }
		68 |   }
		69 | 
		70 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_lambda_function.inscripciones" file="/modules/inscripcionesLambda/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: module.lambda.aws_lambda_function.inscripciones
File: /modules/inscripcionesLambda/main.tf: 50-70
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		50 | resource &quot;aws_lambda_function&quot; &quot;inscripciones&quot; {
		51 |   function_name = var.lambda_function_name
		52 |   role          = aws_iam_role.lambda_exec.arn
		53 |   handler       = var.lambda_handler
		54 |   runtime       = &quot;java17&quot;
		55 | 
		56 |   # Empaquetado: JAR ya compilado
		57 |   filename         = local.jar_path_abs
		58 |   source_code_hash = filebase64sha256(local.jar_path_abs)
		59 | 
		60 |   timeout     = 15
		61 |   memory_size = 512
		62 | 
		63 |   environment {
		64 |     variables = {
		65 |       DDB_TABLE = var.ddb_table_name
		66 |       STAGE     = var.stage
		67 |     }
		68 |   }
		69 | 
		70 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_lambda_function.inscripciones" file="/modules/inscripcionesLambda/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: module.lambda.aws_lambda_function.inscripciones
File: /modules/inscripcionesLambda/main.tf: 50-70
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		50 | resource &quot;aws_lambda_function&quot; &quot;inscripciones&quot; {
		51 |   function_name = var.lambda_function_name
		52 |   role          = aws_iam_role.lambda_exec.arn
		53 |   handler       = var.lambda_handler
		54 |   runtime       = &quot;java17&quot;
		55 | 
		56 |   # Empaquetado: JAR ya compilado
		57 |   filename         = local.jar_path_abs
		58 |   source_code_hash = filebase64sha256(local.jar_path_abs)
		59 | 
		60 |   timeout     = 15
		61 |   memory_size = 512
		62 | 
		63 |   environment {
		64 |     variables = {
		65 |       DDB_TABLE = var.ddb_table_name
		66 |       STAGE     = var.stage
		67 |     }
		68 |   }
		69 | 
		70 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_lambda_function.inscripciones" file="/modules/inscripcionesLambda/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: module.lambda.aws_lambda_function.inscripciones
File: /modules/inscripcionesLambda/main.tf: 50-70
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		50 | resource &quot;aws_lambda_function&quot; &quot;inscripciones&quot; {
		51 |   function_name = var.lambda_function_name
		52 |   role          = aws_iam_role.lambda_exec.arn
		53 |   handler       = var.lambda_handler
		54 |   runtime       = &quot;java17&quot;
		55 | 
		56 |   # Empaquetado: JAR ya compilado
		57 |   filename         = local.jar_path_abs
		58 |   source_code_hash = filebase64sha256(local.jar_path_abs)
		59 | 
		60 |   timeout     = 15
		61 |   memory_size = 512
		62 | 
		63 |   environment {
		64 |     variables = {
		65 |       DDB_TABLE = var.ddb_table_name
		66 |       STAGE     = var.stage
		67 |     }
		68 |   }
		69 | 
		70 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_lambda_function.inscripciones" file="/modules/inscripcionesLambda/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: module.lambda.aws_lambda_function.inscripciones
File: /modules/inscripcionesLambda/main.tf: 50-70
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		50 | resource &quot;aws_lambda_function&quot; &quot;inscripciones&quot; {
		51 |   function_name = var.lambda_function_name
		52 |   role          = aws_iam_role.lambda_exec.arn
		53 |   handler       = var.lambda_handler
		54 |   runtime       = &quot;java17&quot;
		55 | 
		56 |   # Empaquetado: JAR ya compilado
		57 |   filename         = local.jar_path_abs
		58 |   source_code_hash = filebase64sha256(local.jar_path_abs)
		59 | 
		60 |   timeout     = 15
		61 |   memory_size = 512
		62 | 
		63 |   environment {
		64 |     variables = {
		65 |       DDB_TABLE = var.ddb_table_name
		66 |       STAGE     = var.stage
		67 |     }
		68 |   }
		69 | 
		70 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/modules/inscripcionesLambda/main.tf.module.lambda.aws_lambda_function.inscripciones" file="/modules/inscripcionesLambda/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: module.lambda.aws_lambda_function.inscripciones
File: /modules/inscripcionesLambda/main.tf: 50-70
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		50 | resource &quot;aws_lambda_function&quot; &quot;inscripciones&quot; {
		51 |   function_name = var.lambda_function_name
		52 |   role          = aws_iam_role.lambda_exec.arn
		53 |   handler       = var.lambda_handler
		54 |   runtime       = &quot;java17&quot;
		55 | 
		56 |   # Empaquetado: JAR ya compilado
		57 |   filename         = local.jar_path_abs
		58 |   source_code_hash = filebase64sha256(local.jar_path_abs)
		59 | 
		60 |   timeout     = 15
		61 |   memory_size = 512
		62 | 
		63 |   environment {
		64 |     variables = {
		65 |       DDB_TABLE = var.ddb_table_name
		66 |       STAGE     = var.stage
		67 |     }
		68 |   }
		69 | 
		70 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_27] Ensure all data stored in the SQS queue is encrypted" classname="/modules/inscripcionesLambda/sqs-inscripciones.tf.module.lambda.aws_sqs_queue.inscripciones_dlq" file="/modules/inscripcionesLambda/sqs-inscripciones.tf">
			<failure type="failure" message="Ensure all data stored in the SQS queue is encrypted">
Resource: module.lambda.aws_sqs_queue.inscripciones_dlq
File: /modules/inscripcionesLambda/sqs-inscripciones.tf: 8-11
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		8  | resource &quot;aws_sqs_queue&quot; &quot;inscripciones_dlq&quot; {
		9  |   name                      = &quot;${var.sqs_queue_name}-dlq&quot;
		10 |   message_retention_seconds = 1209600   # 14 días
		11 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_27] Ensure all data stored in the SQS queue is encrypted" classname="/modules/inscripcionesLambda/sqs-inscripciones.tf.module.lambda.aws_sqs_queue.inscripciones_queue" file="/modules/inscripcionesLambda/sqs-inscripciones.tf">
			<failure type="failure" message="Ensure all data stored in the SQS queue is encrypted">
Resource: module.lambda.aws_sqs_queue.inscripciones_queue
File: /modules/inscripcionesLambda/sqs-inscripciones.tf: 13-28
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		13 | resource &quot;aws_sqs_queue&quot; &quot;inscripciones_queue&quot; {
		14 |   name                       = var.sqs_queue_name
		15 |   receive_wait_time_seconds  = 10
		16 |   message_retention_seconds  = 345600   # 4 días
		17 |   visibility_timeout_seconds = 90       # &gt;= 6x timeout Lambda (6*15=90)
		18 | 
		19 |   redrive_policy = jsonencode({
		20 |     deadLetterTargetArn = aws_sqs_queue.inscripciones_dlq.arn
		21 |     maxReceiveCount     = 5
		22 |   })
		23 | 
		24 |   tags = {
		25 |     Service     = &quot;Inscripciones&quot;
		26 |     Environment = var.stage
		27 |   }
		28 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_47] Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf">
			<failure type="failure" message="Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability">
Resource: aws_cloudfront_distribution.website_distribution
File: /cloudfront-timbaTumbao.tf: 50-98
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-47

		50 | resource &quot;aws_cloudfront_distribution&quot; &quot;website_distribution&quot; {
		51 |   origin {
		52 |     domain_name = aws_s3_bucket.website_bucket.bucket_regional_domain_name
		53 |     origin_id   = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		54 | 
		55 |     s3_origin_config {
		56 |       origin_access_identity = aws_cloudfront_origin_access_identity.origin_access_identity.cloudfront_access_identity_path
		57 |     }
		58 |   }
		59 | 
		60 |   enabled         = true
		61 |   is_ipv6_enabled = true
		62 |   default_root_object = &quot;index.html&quot;
		63 | 
		64 |   # Si aún no tienes dominio, comenta esta parte (aliases) y usa solo el domain_name que da CloudFront
		65 |   aliases = [&quot;thumbnailcritique.com&quot;]
		66 | 
		67 |   default_cache_behavior {
		68 |     allowed_methods  = [&quot;GET&quot;, &quot;HEAD&quot;, &quot;OPTIONS&quot;]
		69 |     cached_methods   = [&quot;GET&quot;, &quot;HEAD&quot;]
		70 |     target_origin_id = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		71 | 
		72 |     forwarded_values {
		73 |       query_string = false
		74 |       cookies {
		75 |         forward = &quot;none&quot;
		76 |       }
		77 |     }
		78 | 
		79 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		80 |     min_ttl     = 0
		81 |     default_ttl = 3600
		82 |     max_ttl     = 86400
		83 |   }
		84 | 
		85 |   restrictions {
		86 |     geo_restriction {
		87 |       restriction_type = &quot;none&quot;
		88 |     }
		89 |   }
		90 | 
		91 |   viewer_certificate {
		92 |     acm_certificate_arn      = aws_acm_certificate.cloudfront.arn
		93 |     ssl_support_method       = &quot;sni-only&quot;
		94 |     minimum_protocol_version = &quot;TLSv1.2_2021&quot;
		95 |   }
		96 | 
		97 |   depends_on = [aws_acm_certificate_validation.cloudfront]
		98 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_65] Ensure access control lists for S3 buckets are disabled" classname="/bucket-timbaTumbao.tf.aws_s3_bucket_ownership_controls.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure access control lists for S3 buckets are disabled">
Resource: aws_s3_bucket_ownership_controls.website_bucket
File: /bucket-timbaTumbao.tf: 16-23
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-112

		16 | resource &quot;aws_s3_bucket_ownership_controls&quot; &quot;website_bucket&quot; {
		17 |   bucket = aws_s3_bucket.website_bucket.id
		18 | 
		19 |   rule {
		20 |     object_ownership = &quot;BucketOwnerPreferred&quot;
		21 |     #Ejemplo: Yo como propietario del bucket y otro usuario carga objetos dentro de él, con la regla BucketOwnerPreferred esos objetos pasan automáticamente a ser de mi propiedad como dueño del bucket
		22 |   }
		23 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_18] Ensure the S3 bucket has access logging enabled" classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure the S3 bucket has access logging enabled">
Resource: aws_s3_bucket.website_bucket
File: /bucket-timbaTumbao.tf: 3-11
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging

		3  | resource &quot;aws_s3_bucket&quot; &quot;website_bucket&quot; {
		4  |   bucket = &quot;wdc-my-website-bucket&quot;  
		5  | ## Nombre del bucket. Si se omite, Terraform asignará un nombre aleatorio y único.
		6  | 
		7  |   tags = {
		8  |     Name        = &quot;My Website Bucket&quot;
		9  |     Environment = &quot;Dev&quot;
		10 |   }
		11 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_144] Ensure that S3 bucket has cross-region replication enabled" classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure that S3 bucket has cross-region replication enabled">
Resource: aws_s3_bucket.website_bucket
File: /bucket-timbaTumbao.tf: 3-11
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled

		3  | resource &quot;aws_s3_bucket&quot; &quot;website_bucket&quot; {
		4  |   bucket = &quot;wdc-my-website-bucket&quot;  
		5  | ## Nombre del bucket. Si se omite, Terraform asignará un nombre aleatorio y único.
		6  | 
		7  |   tags = {
		8  |     Name        = &quot;My Website Bucket&quot;
		9  |     Environment = &quot;Dev&quot;
		10 |   }
		11 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_32] Ensure CloudFront distribution has a response headers policy attached" classname="/cloudfront-timbaTumbao.tf.aws_cloudfront_distribution.website_distribution" file="/cloudfront-timbaTumbao.tf">
			<failure type="failure" message="Ensure CloudFront distribution has a response headers policy attached">
Resource: aws_cloudfront_distribution.website_distribution
File: /cloudfront-timbaTumbao.tf: 50-98
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65

		50 | resource &quot;aws_cloudfront_distribution&quot; &quot;website_distribution&quot; {
		51 |   origin {
		52 |     domain_name = aws_s3_bucket.website_bucket.bucket_regional_domain_name
		53 |     origin_id   = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		54 | 
		55 |     s3_origin_config {
		56 |       origin_access_identity = aws_cloudfront_origin_access_identity.origin_access_identity.cloudfront_access_identity_path
		57 |     }
		58 |   }
		59 | 
		60 |   enabled         = true
		61 |   is_ipv6_enabled = true
		62 |   default_root_object = &quot;index.html&quot;
		63 | 
		64 |   # Si aún no tienes dominio, comenta esta parte (aliases) y usa solo el domain_name que da CloudFront
		65 |   aliases = [&quot;thumbnailcritique.com&quot;]
		66 | 
		67 |   default_cache_behavior {
		68 |     allowed_methods  = [&quot;GET&quot;, &quot;HEAD&quot;, &quot;OPTIONS&quot;]
		69 |     cached_methods   = [&quot;GET&quot;, &quot;HEAD&quot;]
		70 |     target_origin_id = &quot;S3-${aws_s3_bucket.website_bucket.bucket}&quot;
		71 | 
		72 |     forwarded_values {
		73 |       query_string = false
		74 |       cookies {
		75 |         forward = &quot;none&quot;
		76 |       }
		77 |     }
		78 | 
		79 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		80 |     min_ttl     = 0
		81 |     default_ttl = 3600
		82 |     max_ttl     = 86400
		83 |   }
		84 | 
		85 |   restrictions {
		86 |     geo_restriction {
		87 |       restriction_type = &quot;none&quot;
		88 |     }
		89 |   }
		90 | 
		91 |   viewer_certificate {
		92 |     acm_certificate_arn      = aws_acm_certificate.cloudfront.arn
		93 |     ssl_support_method       = &quot;sni-only&quot;
		94 |     minimum_protocol_version = &quot;TLSv1.2_2021&quot;
		95 |   }
		96 | 
		97 |   depends_on = [aws_acm_certificate_validation.cloudfront]
		98 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_62] Ensure S3 buckets should have event notifications enabled" classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure S3 buckets should have event notifications enabled">
Resource: aws_s3_bucket.website_bucket
File: /bucket-timbaTumbao.tf: 3-11
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62

		3  | resource &quot;aws_s3_bucket&quot; &quot;website_bucket&quot; {
		4  |   bucket = &quot;wdc-my-website-bucket&quot;  
		5  | ## Nombre del bucket. Si se omite, Terraform asignará un nombre aleatorio y único.
		6  | 
		7  |   tags = {
		8  |     Name        = &quot;My Website Bucket&quot;
		9  |     Environment = &quot;Dev&quot;
		10 |   }
		11 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_21] Ensure all data stored in the S3 bucket have versioning enabled" classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure all data stored in the S3 bucket have versioning enabled">
Resource: aws_s3_bucket.website_bucket
File: /bucket-timbaTumbao.tf: 3-11
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning

		3  | resource &quot;aws_s3_bucket&quot; &quot;website_bucket&quot; {
		4  |   bucket = &quot;wdc-my-website-bucket&quot;  
		5  | ## Nombre del bucket. Si se omite, Terraform asignará un nombre aleatorio y único.
		6  | 
		7  |   tags = {
		8  |     Name        = &quot;My Website Bucket&quot;
		9  |     Environment = &quot;Dev&quot;
		10 |   }
		11 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_61] Ensure that an S3 bucket has a lifecycle configuration" classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure that an S3 bucket has a lifecycle configuration">
Resource: aws_s3_bucket.website_bucket
File: /bucket-timbaTumbao.tf: 3-11
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61

		3  | resource &quot;aws_s3_bucket&quot; &quot;website_bucket&quot; {
		4  |   bucket = &quot;wdc-my-website-bucket&quot;  
		5  | ## Nombre del bucket. Si se omite, Terraform asignará un nombre aleatorio y único.
		6  | 
		7  |   tags = {
		8  |     Name        = &quot;My Website Bucket&quot;
		9  |     Environment = &quot;Dev&quot;
		10 |   }
		11 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_6] Ensure that S3 bucket has a Public Access block" classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure that S3 bucket has a Public Access block">
Resource: aws_s3_bucket.website_bucket
File: /bucket-timbaTumbao.tf: 3-11
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached

		3  | resource &quot;aws_s3_bucket&quot; &quot;website_bucket&quot; {
		4  |   bucket = &quot;wdc-my-website-bucket&quot;  
		5  | ## Nombre del bucket. Si se omite, Terraform asignará un nombre aleatorio y único.
		6  | 
		7  |   tags = {
		8  |     Name        = &quot;My Website Bucket&quot;
		9  |     Environment = &quot;Dev&quot;
		10 |   }
		11 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_145] Ensure that S3 buckets are encrypted with KMS by default" classname="/bucket-timbaTumbao.tf.aws_s3_bucket.website_bucket" file="/bucket-timbaTumbao.tf">
			<failure type="failure" message="Ensure that S3 buckets are encrypted with KMS by default">
Resource: aws_s3_bucket.website_bucket
File: /bucket-timbaTumbao.tf: 3-11
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default

		3  | resource &quot;aws_s3_bucket&quot; &quot;website_bucket&quot; {
		4  |   bucket = &quot;wdc-my-website-bucket&quot;  
		5  | ## Nombre del bucket. Si se omite, Terraform asignará un nombre aleatorio y único.
		6  | 
		7  |   tags = {
		8  |     Name        = &quot;My Website Bucket&quot;
		9  |     Environment = &quot;Dev&quot;
		10 |   }
		11 | }
</failure>
		</testcase>
	</testsuite>
</testsuites>
